---
title: "Phish Casefile: \"System Shutdown\" (Payment Update Lure)"
description: "A safe, repeatable workflow to preserve a suspicious email, extract headers + links, and document a redirector chain (email → IP → landing domain) without detonating the payload."
date: "2025-12-14"
slug: "phishing-investigation-system-shutdown"
tags: ["phishing", "dfir", "email-security", "ioc", "heyosj", "incident-response"]
order: 1
repo: ""
---

> **TL;DR** — I downloaded the email as an `.eml`, hashed it for integrity, extracted headers + HTML safely, and proved the CTA link routed through an IP-based redirector (`130.250.191.154`) before landing on a separate domain behind Cloudflare. The email passed SPF/DKIM/DMARC — a good reminder that **auth ≠ trustworthy**.

# Phish Casefile: “System Shutdown” (Payment Update Lure)

This is a walk-through of how I investigate a suspicious email **without clicking links** or opening attachments, plus the IOCs I pulled for blocking/hunting.

The headline lesson: attackers don’t always spoof a brand — sometimes they use (or compromise) real infrastructure and still get **SPF/DKIM/DMARC = pass**.

---

## 1) Evidence preservation (don’t skip)

I started by downloading the message as **`.eml`** and moving it into an analysis VM. Then I generated a SHA-256 hash so I can prove the artifact didn’t change while I worked it.

```bash
mkdir -p ~/cases/phish-1
cp "<path-to-email>.eml" ~/cases/phish-1/msg1.eml
cd ~/cases/phish-1
sha256sum msg1.eml | tee msg1.sha256
```

**Artifact hash**

- `msg1.eml` SHA256: `20c29c610ec3657845829ced34cdbf7068c5212f45ba4f9528fbe66612efb121e`

---

## 2) Header triage (who *actually* sent this?)

From the raw header block, Gmail’s auth results showed the sender domain authenticated:

- SPF: **pass**
- DKIM: **pass**
- DMARC: **pass** (policy visible in headers)

That means this wasn’t “basic From: spoofing” — it was sent using infrastructure authorized for the sending domain.

### Why that matters

If you only trust “SPF pass,” you’ll miss this kind of campaign entirely. You still have to look at:

- Sender domain reputation / relevance to the message
- Lure content (“Apple/iCloud”-style copy coming from a random domain)
- Link routing + landing infrastructure

---

## 3) Body analysis (safe extraction, no mail client rendering)

I extracted the HTML and searched for link targets instead of opening the email in a mail client.

```bash
# Extract and grep (example pattern)
grep -RniE 'href=|src=|action=' msg1.eml | head
```

The CTA link was the weird part:

- It used an **IPv6 literal** that looked like: `::ffff:82fa:bf9a`
- That is an **IPv6-mapped IPv4** address.

I converted it:

```python
import ipaddress
ip6 = ipaddress.ip_address("::ffff:82fa:bf9a")
print(ip6.ipv4_mapped)
```

Result: **`130.250.191.154`**

So the “button” was effectively sending victims to:

- `hxxp://130[.]250[.]191[.]154/qs=...`

---

## 4) Redirect chain (HEAD requests only)

To avoid rendering the payload, I used **header-only** requests to observe behavior:

```bash
curl -sS -I --max-time 10 "http://130.250.191.154/qs=<token>" | sed -n '1,25p'
```

What I observed:

- Some `/qs=...` tokens returned **302** to `optdown.php?n=7`
- Another `/qs=ua-...` token returned **302** to a separate domain:
  - `hxxps://www[.]shoecatphone[.]com/o-hzxc-i03-510dde3d3685c33cec09259b14c815ae`

So the high-level delivery flow was:

1) Email CTA → `http://130.250.191.154/qs=...`  
2) 302 redirect → landing domain (`shoecatphone[.]com/...`)  

This is classic “redirector/TDS”-style behavior: track/rout clicks using a token, then send you to the real lure site.

---

## 5) Network registration context (keep it factual, not personal)

I looked up the netblock in the RIPE database to identify the hosting provider responsible for the IP space and the abuse contact.

Key takeaways:

- `130.250.191.0/24` is registered in RIPE and associated with a hosting provider (India).
- An abuse mailbox was provided for the netblock (useful for takedown reporting).

I’m intentionally not publishing street addresses/phone numbers from WHOIS/RIPE on my personal site — for this kind of write-up, infrastructure + evidence is enough.

---

## 6) Indicators of Compromise (IOCs)

### Domains (defanged)

- `nandakan[.]com` *(sender domain observed in headers)*
- `shoecatphone[.]com` *(redirect landing)*

### IPs

- `130[.]250[.]191[.]154` *(redirector host inferred from IPv6-mapped link + observed behavior)*

### URLs (defanged)

- `hxxp://130[.]250[.]191[.]154/qs=<token>`
- `hxxp://130[.]250[.]191[.]154/optdown[.]php?n=7`
- `hxxps://www[.]shoecatphone[.]com/o-hzxc-i03-510dde3d3685c33cec09259b14c815ae`

### File hash

- `SHA256(msg1.eml)=20c29c610ec3657845829ced34cdbf7068c5212f45ba4f9528fbe66612efb121e`

---

## 7) Why this was phishing (evidence-based)

- **Lure mismatch:** “System shutdown” + “update payment to prevent data loss” copy didn’t align with sender domain identity.
- **IP-based CTA routing:** Legit services almost never send you to raw IPs with opaque tokens.
- **Tokenized redirect flow:** `/qs=...` → 302 → unrelated landing domain is consistent with a click-tracking redirector in a phishing chain.
- **Filter padding:** Large unrelated text blocks in the body (keyword soup) are common evasion tricks.

---

## 8) Defensive actions (practical)

### User-side
- Don’t click. Don’t reply. Don’t open attachments.
- If someone did click: reset credentials, review sessions, and check mailbox rules/forwarding.

### Org-side
- Block/monitor:
  - `130.250.191.154`
  - `shoecatphone[.]com`
  - `nandakan[.]com` (context-dependent; I’d treat as suspicious for now)
- Alert on **messages containing raw IP hyperlinks** (high-signal heuristic).
- Monitor for **newly-seen sender domains** that still pass SPF/DKIM/DMARC.

---

## 9) Reporting / takedown (optional but responsible)

If you’re in a position to report:
- Provide the `.eml` hash, defanged URLs, and the redirect evidence (`curl -I` output).
- Report to:
  - the hosting provider abuse contact for the IP block
  - the domain registrar / CDN provider for the landing domain (if applicable)

Stick to facts, include artifacts, and avoid speculation.

---

## Closing note

This case is a good reminder that “email authentication passed” does not mean “safe.” The safest workflow is still:

**preserve → parse headers → extract links offline → observe redirects safely → document IOCs.**
